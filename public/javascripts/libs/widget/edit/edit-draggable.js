"use strict";function _classCallCheck(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,e){for(var r=0;r<e.length;r++){var t=e[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,t.key,t)}}return function(e,r,t){return r&&a(e.prototype,r),t&&a(e,t),e}}(),EditDraggable=function(){function a(){_classCallCheck(this,a),this.topWindow=window.top,this.topModal=this.topWindow.$(".modal-content")}return _createClass(a,[{key:"makeDraggable",value:function(a){var e=this;a.on("dragstart",function(a){e.handleDragStart(a)}),a.on("dragenter",function(a){e.handleDragEnter(a)}),a.on("dragover",function(a){e.handleDragOver(a)}),a.on("dragleave",function(a){e.handleDragLeave(a)}),a.on("drop",function(a){e.handleDragDrop(a)}),a.on("dragend",function(a){e.handleDragEnd(a)})}},{key:"handleDragStart",value:function(a){return this.draggableContainer().addClass("dragging"),this.dragElem=window.top.$(a.currentTarget),this.dragElem.addClass("dragElem"),a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("text/plain",JSON.stringify(this.draggableData())),!1}},{key:"handleDragEnter",value:function(a){return a.preventDefault(),this.handleDragHover(a),!1}},{key:"handleDragOver",value:function(a){return this.handleDragHover(a),a.dataTransfer.dropEffect="move",a.preventDefault(),!1}},{key:"handleDragHover",value:function(a){var e=this.topWindow.$(a.currentTarget);e.addClass("dragHover");var r=a.originalEvent.pageX,t=e.offset().left+.5*e.width();return r<=t?e.removeClass("rightHalf").addClass("leftHalf"):e.removeClass("leftHalf").addClass("rightHalf"),!1}},{key:"handleDragLeave",value:function(a){var e=this.topWindow.$(a.currentTarget);return e.removeClass("rightHalf leftHalf dragHover"),a.preventDefault(),!1}},{key:"handleDragDrop",value:function(a){var e=this,r=this.topWindow.$(a.currentTarget),t=this.dragElem.data("index"),n=r.data("index");if(t!==n){var l=this.draggableClass()+"[data-index="+t+"]",o=this.draggableContainer().find(l);r.hasClass("leftHalf")?r.before(o.detach()):r.hasClass("rightHalf")&&r.after(o.detach()),this.afterDragDrop()}return this.dragElem.css({opacity:1}),this.dragElem.removeClass("dragElem dragHover"),this.draggableObjects().each(function(a,r){var t=e.topWindow.$(r);t.removeClass("rightHalf leftHalf dragHover"),t.css({opacity:1})}),this.draggableContainer().removeClass("dragging"),a.preventDefault(),a.stopPropagation(),$(window).trigger("dragDrop"),!1}},{key:"handleDragEnd",value:function(a){return this.dragElem.removeClass("dragElem"),this.dragElem=null,a.preventDefault(),!1}},{key:"afterDragDrop",value:function(){throw new Error("afterDragDrop not defined")}},{key:"draggableContainer",value:function(){throw new Error("draggableContainer not defined")}},{key:"draggableClass",value:function(){throw new Error("draggableClass not defined")}},{key:"draggableData",value:function(){throw new Error("draggableData not defined")}},{key:"draggableObjects",value:function(){throw new Error("draggableObjects not defined")}}]),a}();