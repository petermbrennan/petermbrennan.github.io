"use strict";function _classCallCheck(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function i(i,e){for(var t=0;t<e.length;t++){var s=e[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}return function(e,t,s){return t&&i(e.prototype,t),s&&i(e,s),e}}(),FlexSliderWidget=function(){function i(e){_classCallCheck(this,i),this.configs=e,this.widget=$("#"+this.configs.widgetId),this.lazyLoadSlides(),this.setupFlexslider(),this.setupResize()}return _createClass(i,[{key:"lazyLoadSlides",value:function(){var i=this,e=this.widget.find("img.lazy-slide");e.each(function(i,e){var t=$(e);t.attr("src",t.data("src")).removeAttr("data-src")}),e.on("load",function(e){i.resize(),i.widget.addClass("loaded")})}},{key:"setupFlexslider",value:function(){this.initializeFlexSlider();var i=this.getLargestImage(),e=i.height;this.isMiniGallery()?this.setMiniNavHeight(e):this.setImageHeight(e)}},{key:"initializeFlexSlider",value:function(){this.isCarousel()?this.initializeGalleryCarousel():this.initializeGallerySlideshow()}},{key:"initializeGalleryCarousel",value:function(){var i=this;this.widget.find(".gallery-carousel").flexslider({animation:"slide",animationLoop:!0,itemWidth:350,itemMargin:15,slideshowSpeed:this.slideshowSpeed(),minItems:this.getGridSize(),maxItems:this.getGridSize(),start:function(e){i.flexslider=e}})}},{key:"initializeGallerySlideshow",value:function(){var i=this,e=!this.showThumbnails()||"thumbnails";this.widget.find(".gallery-slideshow").flexslider({animation:"fade",useCSS:!0,touch:!0,directionNav:!0,slideshowSpeed:this.slideshowSpeed(),controlNav:e,start:function(e){i.flexslider=e}})}},{key:"getGridSize",value:function(){var i=window.innerWidth;return i<641?1:i<910?2:3}},{key:"setupResize",value:function(){var i=this;$(window).smartresize(function(){i.resize()}),setTimeout(function(){i.resize()},300)}},{key:"resize",value:function(){this.isMiniGallery()?this.resetMiniFlexslider():this.resetFlexslider()}},{key:"resetFlexslider",value:function(){var i=this.getLargestImage();if(this.setImageHeight(i.height),this.isCarousel()){var e=this.getGridSize();this.flexslider&&(this.flexslider.vars.minItems=e,this.flexslider.vars.maxItems=e)}}},{key:"resetMiniFlexslider",value:function(){var i=this.getLargestImage();this.setMiniNavHeight(i.height)}},{key:"setMiniNavHeight",value:function(i){this.widget.find(".flex-direction-nav a").height(i)}},{key:"getLargestImage",value:function(){var i=this.widget.find(".slides li"),e=this.widget.find(".slides img");i.addClass("loading"),e.css("max-height","none");var t=0,s=0,n=[];return e.each(function(i,e){var n=$(e).height();n>t&&(t=n,s=$(e).width())}),i.removeClass("loading"),n.height=t,n.width=s,n}},{key:"setImageHeight",value:function(i){var e=$(window).height(),t=this.widget.find(".flex-control-nav").outerHeight(!0),s=null;e<=i+t?(s=e-t,s<320&&(s=i)):s=i,this.isCarousel()||(this.widget.find(".slides img").css("max-height",s),this.widget.find(".slides li").css("height",s)),this.widget.find(".flex-control-nav").css("bottom",-t),this.widget.find(".flexslider").css("margin-bottom",t)}},{key:"isMiniGallery",value:function(){return"yes"===this.configs.mini_gallery}},{key:"isCarousel",value:function(){return"yes"===this.configs.carousel}},{key:"showThumbnails",value:function(){return"yes"===this.configs.show_thumbnails}},{key:"imagePadding",value:function(){this.configs.image_padding||0}},{key:"slideshowSpeed",value:function(){return this.configs.slideshow_speed||6e3}}]),i}();