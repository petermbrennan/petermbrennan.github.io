(function(){var t;t=function(){function t(t){this.configs=t,this.widget=$("#"+this.configs.widgetId),this.widgetElement=this.widget.find(".search-form"),this.searchInput=this.widget.find(".search-input"),this.searchSubmit=this.widget.find(".loc-search-btn"),this.stateSelect=this.widget.find(".search-states"),this.citySelect=this.widget.find(".search-cities"),this.neighborhoodSelect=this.widget.find(".search-neighborhoods"),this.brandedName="",this.cityName="",this.neighborhoodName="",this.postalCode="",this.stateName="",this.wildcard="",this.FULL_WIDTH=800,this.SMALL_WIDTH=400,"false"===this.configs.universalSearch&&this.setupSearchStandard(),"true"===this.configs.universalSearch&&this.setupSearchTypeahead(),this.initResize()}return t.prototype.setupSearchStandard=function(){return this.apiRequest(),this.selectChange(),this.linkHref()},t.prototype.setupSearchTypeahead=function(){return this.apiRequest(),this.typeAheadSelect(),this.typeAheadSelected(),this.typeaheadCursorChangeVal(),this.typedComplete(),this.changeToWildcard(),this.inputWildcard(),this.keyUp(),this.clearInput(),this.linkHref()},t.prototype.initResize=function(){return $(window).on("resize orientationchange",function(t){return function(){return t.resize()}}(this)),this.resize()},t.prototype.resize=function(){var t,e;return t=this.widgetElement.parent(".widget"),e=t.width(),e>=this.FULL_WIDTH?this.setSizeClass("xlarge"):e>=this.SMALL_WIDTH?this.setSizeClass("small narrow"):e<this.SMALL_WIDTH?this.setSizeClass("narrow"):void 0},t.prototype.setSizeClass=function(t){if(!this.widgetElement.hasClass(t))return this.clearSizeClasses(),this.widgetElement.addClass(t)},t.prototype.clearSizeClasses=function(){return this.widgetElement.removeClass("narrow").removeClass("small").removeClass("xlarge")},t.prototype.apiRequest=function(){var t,e;return t=this.configs.clientURN.replace(/\s+/g,""),e="true"===this.configs.includePending?"&include_pending=true":"",$.ajax({url:this.configs.serviceURL+"/api/v3/client_search_data?client_urns="+t+e,dataType:"json",success:function(t){return function(e){if(null!==e&&"true"===t.configs.universalSearch&&t.typeAheadBuilder(e),"false"===t.configs.universalSearch)return t.corpSearchMarkupBuilder(e)}}(this),error:function(t){return function(){return t.widget.replaceWith("We are experiencing difficulty with our server to display this Search function, please refresh or check back later.  Thank you.")}}(this)})},t.prototype.linkHref=function(){var t,e;return t=[],this.brandedName&&t.push("brandedName="+this.brandedName),this.cityName&&t.push("city="+this.cityName),this.neighborhoodName&&t.push("neighborhoods="+this.neighborhoodName),t.push("page=1"),this.postalCode&&t.push("postalCode="+this.postalCode),this.stateName&&t.push("state="+this.stateName),""===this.stateName&&t.push("wildcard="+this.wildcard),e="?"+t.join("&").replace(/\+/g,"%2B"),this.searchSubmit.attr("href",this.configs.corpSearchPage+"/#/locations"+e)},t.prototype.corpSearchMarkupBuilder=function(t){return this.optionsBuilder(t.states,this.stateSelect),this.stateSelect.change(function(e){return function(){return e.citySelectUpdater(t,e.stateSelect,e.citySelect)}}(this)),this.citySelect.change(function(e){return function(){return e.neighborhoodSelectUpdater(t,e.citySelect,e.neighborhoodSelect)}}(this))},t.prototype.citySelectUpdater=function(t,e,i){var n,r;return i.html("<option value=''>City</option>"),r=e.val(),n=t.cities.filter(function(t){return t.state_id===parseInt(r,10)}),this.optionsBuilder(n,i)},t.prototype.neighborhoodSelectUpdater=function(t,e,i){var n,r;return i.html("<option value=''>Neighborhood</option>"),r=e.val(),n=t.neighborhoods.filter(function(t){return t.city_id===parseInt(r,10)}),this.optionsBuilder(n,i)},t.prototype.optionsBuilder=function(t,e){var i,n,r,a,s;for(a=[],n=i=0,r=t.length;i<r;n=++i)s=t[n],"State"===e.text().trim()?a.push("<option value='"+s.id+"'>"+s.name_abbr+"</option>"):a.push("<option value='"+s.id+"'>"+s.name+"</option>");return e.append(a.join(""))},t.prototype.selectChange=function(){return this.stateSelect.change(function(t){return function(e){var i;return i=$(e.currentTarget).find("option:selected").html(),t.stateName="State"===i?"":i,t.cityName="",t.linkHref()}}(this)),this.citySelect.change(function(t){return function(e){var i;return i=$(e.currentTarget).find("option:selected").html(),t.cityName="City"===i?"":i,t.linkHref()}}(this)),this.neighborhoodSelect.change(function(t){return function(e){var i;return i=$(e.currentTarget).find("option:selected").html(),t.neighborhoodName="Neighborhood"===i?"":i,t.linkHref()}}(this))},t.prototype.typeAheadBuilder=function(t){var e,i,n,r,a,s,o,h,c,u,l,p,d,f,g,y,m,v,S,w,b,C,I,k;for(k=[],v=t.branded_names,o=0,l=v.length;o<l;o++)e=v[o],i=e.name,k.push({loc:i,branded_name:i});for(S=t.states,h=0,p=S.length;h<p;h++)for(C=S[h],g=C.name,I=C.name,k.push({loc:g,state:I}),w=C.cities,c=0,d=w.length;c<d;c++)a=w[c],r=t.cities.filter(function(t){return t.id===a}),n=r[0].name,I=C.name,s=n+", "+I,k.push({city:n,state:I,loc:s});for(b=t.postal_codes,u=0,f=b.length;u<f;u++)y=b[u],m=y.postal_code,k.push({loc:m,postal_code:m});return this.initializeTypeahead(k)},t.prototype.initializeTypeahead=function(t){var e,i,n;return n={autoselect:!0,minLength:1,highlight:!0},e={name:"locations",source:function(t,e){return""===t?e(i.local):i.search(t,e)},display:"loc",limit:100},i=new Bloodhound({local:t,identify:function(t){return t.loc},datumTokenizer:Bloodhound.tokenizers.obj.whitespace("loc"),queryTokenizer:Bloodhound.tokenizers.whitespace}),this.dataLocations=i,this.searchInput.typeahead(n,e)},t.prototype.emptyParams=function(){return this.brandedName="",this.cityName="",this.postalCode="",this.stateName=""},t.prototype.typeAheadSelect=function(){return this.searchInput.on("typeahead:select typeahead:autocompleted",function(t){return function(e){var i;return i=t.dataLocations.index.datums[e.currentTarget.value],t.brandedName=i.branded_name,t.cityName=i.city,t.postalCode=i.postal_code,t.stateName=i.state,t.linkHref()}}(this))},t.prototype.typeAheadSelected=function(){return this.searchInput.on("typeahead:selected typeahead:autocompleted",function(t){return function(e){var i;return i=$(e.currentTarget).typeahead("val"),t.typeaheadCurrentVal=e.target.value,t.linkHref(),t.searchInput.typeahead("close")}}(this))},t.prototype.typeaheadCursorChangeVal=function(){return this.searchInput.on("typeahead:cursorchange",function(t){return function(e){return t.typeaheadCurrentVal=e.target.value}}(this))},t.prototype.typedComplete=function(){return this.searchInput.bind("typeahead:close",function(t){return function(e){var i,n,r;if(n=t.searchInput.siblings(".tt-menu"),r=n.find(".tt-suggestion"),i=t.searchInput.typeahead("val"),void 0!==r.first()[0]&&i.toLowerCase()===r.first()[0].innerText.toLowerCase())return r.first().click()}}(this))},t.prototype.changeToWildcard=function(){return this.searchInput.on("typeahead:change",function(t){return function(e){var i,n,r,a;if(n=t.searchInput.siblings(".tt-menu"),a=n.find(".tt-suggestion"),r=a.first()[0],i=t.searchInput.typeahead("val"),void 0===r&&i.length>=1||void 0!==r.innerText&&i!==r.innerText)return t.emptyParams(),t.wildcard=i,t.linkHref()}}(this))},t.prototype.inputWildcard=function(){return this.searchInput.on("keyup",function(t){return function(e){return t.wildcard=t.widget.find(".search-input.tt-input").val(),t.linkHref()}}(this))},t.prototype.keyUp=function(){return this.searchInput.on("keyup",function(t){return function(e){var i,n,r;if(n=t.searchInput.siblings(".tt-menu"),r=n.find(".tt-suggestion"),i=t.searchInput.typeahead("val"),8===e.which&&i.length&&void 0===r.first()[0]&&(t.emptyParams(),t.wildcard=i,t.linkHref()),8===e.which&&0===i.length&&t.blankOutInput(),9!==e.which&&13!==e.which||(t.typeaheadCurrentVal?t.searchInput.typeahead("val"):r.first().click()),27===e.which)return t.blankOutInput()}}(this))},t.prototype.blankOutInput=function(){return this.typeaheadCurrentVal=void 0,this.emptyParams(),this.wildcard="",this.searchInput.blur(),this.searchInput.typeahead("val",""),this.linkHref()},t.prototype.clearInput=function(){return this.widget.find(".input-clear").on("click",function(t){return function(){return t.blankOutInput()}}(this))},t}(),G5.loadWidgetConfigs(".location-mini-search .config",t)}).call(this);