"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,s){for(var i=0;i<s.length;i++){var t=s[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(s,i,t){return i&&e(s.prototype,i),t&&e(s,t),s}}(),MiniBlogFeedWidget=function e(s){var i=this;_classCallCheck(this,e),this.configs=s,this.widget=$("#"+this.configs.widgetId);var t=this.configs.newsServiceDomain+"/locations/"+this.configs.locationURN+"/news_feed.json",n=new MiniBlogFeedSource(t);$(n).bind("feedReady",function(e){return new MiniBlogFeedLinkBuilder(i.configs,n.feed,i.widget)}),n.getFeed(),new MiniBlogFeedWidthChecker(this.widget)},MiniBlogFeedLinkBuilder=function(){function e(s,i,t){_classCallCheck(this,e),this.configs=s,this.feed=i,this.widget=t,this.populateFeed()}return _createClass(e,[{key:"populateFeed",value:function(){var e=parseInt(this.configs.numberOfPosts);isNaN(e)&&(e=3);var s=this.feed.slice(0,e),i=[],t=""===this.configs.seeMoreNewsText?"See More News":this.configs.seeMoreNewsText,n=this.configs.newsPagePath;n="/"===n[n.length-1]?n.slice(0,n.length-1):n,n+="true"===this.configs.usesStaticPages?"/":"?article=";for(var a=0;a<s.length;a++){var r=s[a],o=n+r.title_slug;i.push("<div class='news-item-preview'>         "+this.imageMarkup(r)+"         <a href="+o+"><h3 class='post-title'>"+r.title+"</h3></a>         "+this.postDetails(r)+"         <div class='post-description'>"+r.description+"</div>         <a class='news-item-link' href="+o+" data-post-index='"+a+"'>         Read More<span class='nav-bling'> ></span>         </a>         </div>")}return i.push(" <div class='all-news'>       <a class='all-news-link' href='"+this.configs.newsPagePath+"'>       "+t+"<span class='nav-bling'> ></span>       </a>       </div> "),this.widget.append(i.join(""))}},{key:"postDetails",value:function(e){var s=" <div class='post-details'>";return s+="<span class='post-date'>"+e.pretty_date+"</span>",""!==e.author&&(s+="<span class='divider'> | </span><span class='post-author'>by "+e.author+"</span>"),s+="</div>"}},{key:"imageMarkup",value:function(e){var s="";if("true"===this.configs.displayPhotos){var i=void 0,t=e.image;""===t&&(t=this.configs.defaultImage),""!==t&&(i="<img src='"+t+"' srcset='"+t+"' />"),i&&(s="<div class='post-image-wrapper'><div>"+i+"</div></div>")}return s}}]),e}(),MiniBlogFeedSource=function(){function e(s){_classCallCheck(this,e),this.url=s}return _createClass(e,[{key:"getFeed",value:function(){return this.feedFromStorage()?$(this).trigger("feedReady"):this.fetch()}},{key:"fetch",value:function(){var e=this;return $.ajax({url:this.url,dataType:"json",success:function(s,i,t){return e.feed=s,e.storeFeed(),$(e).trigger("feedReady")},error:function(e,s,i){}})}},{key:"feedFromStorage",value:function(){try{return this.feed=JSON.parse(sessionStorage.getItem(this.url))}catch(e){return null}}},{key:"storeFeed",value:function(){try{return sessionStorage.setItem(this.url,JSON.stringify(this.feed))}catch(e){return null}}}]),e}(),MiniBlogFeedWidthChecker=function(){function e(s){var i=this;_classCallCheck(this,e),this.widget=s,this.applyWidthClasses(),$(window).resize(function(){return i.applyWidthClasses()})}return _createClass(e,[{key:"applyWidthClasses",value:function(){var e=$(window).width();return e<=590?this.widget.removeClass("wide").addClass("narrow"):this.widget.removeClass("narrow").addClass("wide")}}]),e}();G5.loadWidgetConfigs(".mini-blog-feed .config",MiniBlogFeedWidget);