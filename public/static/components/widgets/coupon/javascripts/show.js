"use strict";function _classCallCheck(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,o){for(var e=0;e<o.length;e++){var n=o[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(o,e,n){return e&&t(o.prototype,e),n&&t(o,n),o}}(),CouponWidget=function(){function t(o){_classCallCheck(this,t),this.configs=o,this.widgetId=this.configs.widgetId,this.widget=$("#"+this.widgetId),this.printButton=this.widget.find(".coupon-print"),this.mapButton=this.widget.find(".show-coupon-map"),this.couponDrawer=this.widget.find(".coupon-drawer"),this.bindEvents(),this.loadGoogleMapsImage()}return _createClass(t,[{key:"bindEvents",value:function(){var t=this;this.couponDrawer.hide(),this.mapButton.on("click",function(o){t.couponDrawer.slideToggle()}),this.printButton.on("click",function(o){t.setCouponVars()})}},{key:"loadGoogleMapsImage",value:function(){var t='<img src="'+this.googleMapsUrl()+'">';this.widget.find(".map-canvas").html(t)}},{key:"googleMapsUrl",value:function(){return"https://maps.googleapis.com/maps/api/staticmap?markers="+(this.configs.streetAddress+","+this.configs.city+","+this.configs.state+","+this.configs.postalCode)+"&zoom=15&size=400x400&scale=2&sensor=false&key="+G5.googleMapsApi.apiKey()}},{key:"setCouponVars",value:function(){this.couponDrawer.show();var t=this.printButton.parents(".coupon"),o=t.outerWidth(!0),e=t.outerHeight(!0),n=t.wrap('<div class="coupon-wrapper"></div>').parent().html();this.printCoupon(n,o,e),t.unwrap()}},{key:"printCoupon",value:function(t,o,e){var n=$("head link[href*=application]").attr("href"),i='<link rel="stylesheet" href="'+n+'">',s=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,a=s+window.innerWidth/2-o/2,c=r+window.innerHeight/2-e/2,u="Print Coupon",p="toolbar=no, location=no, directories=no, status=no, menubar=no, resizable=yes, copyhistory=no, height="+e+", width="+o+", left="+a+", top="+c,l=window.open("",u,p),h="<head><title>Print Coupon</title>"+i+"</head>",d='<body style="border: none">'+t+"</body>";l.document.write("<html>"+h+d+"</html>"),l.document.close(),l.focus(),setTimeout(function(){l.print(),l.close()},500)}}]),t}();G5.loadWidgetConfigs(".coupon .config",CouponWidget);