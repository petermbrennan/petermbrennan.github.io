(function(){var e,t,n,i;t=function(){function t(t){var r;this.configs=t,this.widget=$("#"+this.configs.widgetId),this.review_api_url="https://reputation.g5search.com/api/promoted_reviews/stores/"+this.configs.apiUrlId+".json",this.feedSource=new n(this.review_api_url),"full"===this.configs.review_type?$(this.feedSource).bind("feedReady",function(e){return function(t){return new i(e.configs.branded_name,e.widget).update(e.feedSource.feed)}}(this)):"hcard"===this.configs.review_type&&(r=""===this.configs.insert_review_schema?".contact-info":this.configs.insert_review_schema,$(this.feedSource).bind("feedReady",function(t){return function(n){return new e(r,t.configs.review_page_url,t.widget).update(t.feedSource.feed)}}(this))),this.feedSource.getFeed()}return t}(),n=function(){function e(e){this.url=e}return e.prototype.getFeed=function(){return this.feedFromStorage()?$(this).trigger("feedReady"):this.fetch()},e.prototype.fetch=function(){return $.ajax({url:this.url,dataType:"json",success:function(e){return function(t,n,i){return e.feed=t,e.storeFeed(),$(e).trigger("feedReady")}}(this),error:function(e){return function(e,t,n){}}(this)})},e.prototype.feedFromStorage=function(){try{return this.feed=JSON.parse(sessionStorage.getItem(this.url))}catch(e){return null}},e.prototype.storeFeed=function(){try{return sessionStorage.setItem(this.url,JSON.stringify(this.feed))}catch(e){return null}},e}(),e=function(){function e(e,t,n){this.insert_review_schema=e,this.review_page_url=t,this.widget=n}return e.prototype.update=function(e){if(e.location.review_count>0)return $(this.insert_review_schema).append(this.schemaTemplate(e.location))},e.prototype.schemaTemplate=function(e){return'<div class="ratings-summary-outer">\n  <div class="rating ratings-summary">\n    <span class="average-rating"></span>\n    <a href="'+this.review_page_url+'" class="total-reviews">\n      <span>('+e.review_count+' reviews)</span>\n    </a>\n    <span class="gold-stars" style="width:'+Math.round(16*e.average_rating)+'px;"></span>\n  </div>\n</div>'},e}(),i=function(){function e(e,t){this.branded_name=e,this.widget=t}return e.prototype.update=function(e){var t,n,i,r,s;for(i=e.reviews,r=[],t=0,n=i.length;t<n;t++)s=i[t],r.push(this.widget.find(".promoted-reviews-content").append(this.reviewTemplate(e.location,s)));return r},e.prototype.reviewTemplate=function(e,t){var n,i;return n=(null!=(i=t.review_link)?i.length:void 0)?'<a href="'+t.review_link+'" target="_blank">Read More &gt;</a>':"",'<div class="review">\n  <div class="review-body">'+t.excerpt+n+'</div>\n  <div class="location-name notranslate">'+this.branded_name+'</div>\n  <div class="author">\n    Written by: <span class="notranslate">'+t.author+'</span>\n    <span class="'+this.classifyReputationSiteName(t.reputation_site_name)+' via">\n      via '+t.reputation_site_name+'\n    </span>\n  </div>\n  <div class="date">\n    <meta content="'+t.date+'">Date published: '+t.date+'\n  </div>\n  <div class="rating">\n    <meta content="1"><span>'+t.rating+"</span> / <span>"+e.out_of+'</span> stars\n    <span class="gold-stars" style="width:'+Math.round(16*t.rating)+'px;"></span>\n  </div>\n</div>'},e.prototype.classifyReputationSiteName=function(e){return this.lowercaseFirstChar(e).replace(/[^0-9a-z]/i,"")},e.prototype.lowercaseFirstChar=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},e}(),G5.loadWidgetConfigs(".promoted-reviews .config",t)}).call(this);