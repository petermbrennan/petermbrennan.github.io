"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,s){for(var t=0;t<s.length;t++){var i=s[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(s,t,i){return t&&e(s.prototype,t),i&&e(s,i),s}}(),MapWidget=function(){function e(s){_classCallCheck(this,e),this.configs=s,this.widget=$("#"+this.configs.widgetId),this.canvas=this.widget.find(".canvas"),this.setupConfigs(),this.setupResize(),G5.googleMapsApi.registerWidget(this,"getMapCoords")}return _createClass(e,[{key:"setupConfigs",value:function(){this.address=this.configs.address,this.panZoom=this.configs.panZoom,this.styles=this.configs.styles,this.override=this.configs.overrides,this.latitude=this.configs.latitude,this.longitude=this.configs.longitude}},{key:"getMapCoords",value:function(){var e=this;$.getJSON(G5.googleMapsApi.geocodeUrl(),{address:this.address,sensor:"false"}).done(function(s){if("OK"===s.status){var t=s.results[0].geometry.location;return e.setMap(t)}console.log("Failed to load address at "+e.address)}).fail(function(){console.log("Failed to load Google Maps Geocode API")})}},{key:"setMap",value:function(e){if(this.override===!0)var s={lat:parseFloat(this.latitude),lng:parseFloat(this.longitude)};else var s={lat:e.lat,lng:e.lng};var t={scrollwheel:this.panZoom,draggable:this.panZoom,disableDefaultUI:!this.panZoom,disableDoubleClickZoom:!this.panZoom,zoom:16,center:s,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:this.styles},i={position:s};return this.marker=new google.maps.Marker(i),this.map=new google.maps.Map(this.canvas[0],t),this.marker.setMap(this.map)}},{key:"setupResize",value:function(){var e=this;$(window).smartresize(function(){e.resize()}),this.resize()}},{key:"resize",value:function(){var e=Math.min(800,Math.max(.75*this.canvas.width()+30,200));this.canvas.css({height:e}),this.map&&this.map.setCenter(this.marker.getPosition())}}]),e}();G5.loadWidgetConfigs(".map-v2 .config",MapWidget);