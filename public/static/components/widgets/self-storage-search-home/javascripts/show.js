(function(){var t,e;e=function(){function e(t){this.configs=t,null!==this.configs.destinationPageTest&&(this.widget=$("#"+this.configs.widgetId),this.sssSelect=this.widget.find(".sss-search-storage-categories-select"),this.sssInput=this.widget.find(".sss-search-input"),this.sssSubmit=this.widget.find(".sss-search-btn"),this.category="",this.stateName="",this.cityName="",this.wildcard="",this.setupWidget())}return e.prototype.setupWidget=function(){return this.api_request(),this.linkHref(),this.selectChange(),this.typeAheadChange(),this.clearInput(),this.keyUp(),this.setEvents(),this.setTypeaheadEvents(),this.typedComplete(),this.fieldValue(),new t(this.widget)},e.prototype.api_request=function(){var t,e;return t=this.configs.clientUrn.replace(/\s+/g,""),e="true"===this.configs.includePending?"&include_pending=true":"",$.ajax({url:this.configs.apiHost+"/api/v3/client_search_data?client_urns="+t+e,dataType:"json",success:function(t){return function(e){if(null!==e&&t.typeAheadBuilder(e),null!==e)return t.buildCategories(e)}}(this)})},e.prototype.buildCategories=function(t){var e,s,i,n;for(n=t.categories,s=0,i=n.length;s<i;s++)e=n[s],this.sssSelect.append($("<option>").attr("value",e.name).text(e.name));return this.sssSelect},e.prototype.typeAheadBuilder=function(t){var e,s,i,n,a,r,u,o,h,c,l,d,p,g,f,y,m,w,v,C,I,k;for(k=[],y=t.states,r=0,c=y.length;r<c;r++)for(C=y[r],g=C.name,I=C.name,k.push({loc:g,state:I}),m=C.cities,u=0,l=m.length;u<l;u++)n=m[u],i=t.cities.filter(function(t){return t.id===n}),s=i[0].name,I=C.name,a=s+", "+I,k.push({city:s,state:I,loc:a});for(w=t.postal_codes,o=0,d=w.length;o<d;o++)f=w[o],k.push({loc:f.postal_code});for(v=t.branded_names,h=0,p=v.length;h<p;h++)e=v[h],k.push({loc:e.name});return this.initializeTypeahead(k)},e.prototype.initializeTypeahead=function(t){var e,s,i;return i={autoselect:!0,minLength:1,highlight:!0},e={name:"locations",source:function(t,e){return""===t?e(s.local):s.search(t,e)},display:"loc",limit:100},s=new Bloodhound({local:t,identify:function(t){return t.loc},datumTokenizer:Bloodhound.tokenizers.obj.whitespace("loc"),queryTokenizer:Bloodhound.tokenizers.whitespace}),this.dataLocations=s,this.sssInput.typeahead(i,e)},e.prototype.typeAheadChange=function(){return this.sssInput.on("typeahead:select",function(t){return function(e){var s;return s=t.dataLocations.index.datums[e.currentTarget.value],t.stateName=s.state,t.cityName=s.city,t.wildcard=s.loc,t.linkHref()}}(this))},e.prototype.selectChange=function(){return this.sssSelect.change(function(t){return function(e){var s;return s=$(e.currentTarget).find("option:selected").attr("value"),t.category=s,t.linkHref()}}(this))},e.prototype.fieldValue=function(){return this.sssInput.on("keyup",function(t){return function(e){return t.wildcard=t.widget.find(".sss-search-input.typeahead.tt-input").val(),t.linkHref()}}(this))},e.prototype.linkHref=function(){var t,e;return t=[],this.category&&t.push("category="+encodeURIComponent(this.category)),t.push("page=1"),this.cityName&&this.stateName&&t.push("wildcard="+this.cityName+", "+this.stateName),this.stateName&&!this.cityName&&t.push("state="+this.stateName),this.stateName||t.push("wildcard="+this.wildcard),e="?"+t.join("&").replace(/\+/g,"%2B"),this.widget.find(".sss-search-btn").attr("href",this.configs.destinationPage+"#/locations"+e)},e.prototype.blankOutInput=function(){return this.stateName="",this.cityName="",this.wildcard="",this.sssInput.blur(),this.sssInput.typeahead("val",""),this.linkHref()},e.prototype.clearInput=function(){return this.widget.find(".input-clear").on("click",function(t){return function(){return t.blankOutInput()}}(this))},e.prototype.setEvents=function(){return this.sssInput.on("typeahead:selected typeahead:autocompleted",function(t){return function(e){var s;return s=$(e.currentTarget).typeahead("val"),t.typeaheadCurrentVal=e.target.value,t.linkHref(),t.sssInput.typeahead("close"),t.sssSubmit.focus()}}(this))},e.prototype.setTypeaheadEvents=function(){return this.sssInput.bind("typeahead:cursorchange",function(t){return function(e){return t.typeaheadCurrentVal=e.target.value}}(this))},e.prototype.typedComplete=function(){return this.sssInput.bind("typeahead:close",function(t){return function(e){var s,i;if(null==t.typeaheadCurrentVal)return s=t.sssInput.siblings(".tt-menu"),i=s.find(".tt-suggestion"),i.first().click()}}(this))},e.prototype.keyUp=function(){return this.sssInput.on("keyup",function(t){return function(e){var s,i,n;return i=t.sssInput.siblings(".tt-menu"),n=i.find(".tt-suggestion"),s=t.sssInput.typeahead("val"),0!==n.length&&(8===event.which&&0===s.length&&self.blankOutInput(widgetVars),13===e.which||9===e.which?t.typeaheadCurrentVal?(t.sssInput.typeahead("val"),t.typeaheadCurrentVal=!1):n.first().click():27===e.which?t.blankOutInput():9===e.which&&checkInput.val().length>=1?t.find(".sss-search-input").typeahead("close"):void 0)}}(this))},e}(),t=function(){function t(t){var e;this.widget=t,e=this.getWidth(),this.setClass(e),$(window).resize(function(t){return function(){return e=t.getWidth(),t.setClass(e)}}(this))}return t.prototype.setClass=function(t){return t>1025?(this.widget.removeClass("large medium small"),this.widget.addClass("xlarge")):t>856?(this.widget.removeClass("xlarge medium small"),this.widget.addClass("large")):t>585?(this.widget.removeClass("xlarge large small"),this.widget.addClass("medium")):(this.widget.removeClass("xlarge medium large"),this.widget.addClass("small"))},t.prototype.getWidth=function(){return this.widget.width()},t}(),G5.loadWidgetConfigs(".self-storage-search-home .config",e)}).call(this);